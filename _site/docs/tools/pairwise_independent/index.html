<!DOCTYPE html> <script> window.MathJax = { loader: { load: ['[tex]/physics', '[tex]/mathtools'] }, tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], packages: {'[+]': ['physics','mathtools']}, macros: { Nat: "{\\mathbb{N}}", Real: "{\\mathbb{R}}", F: "\\mathbb{F}", poly: "\\mathrm{poly}", polylog: "\\mathrm{polylog}", E: "{\\mathbb{E}}", Var: "{\\mathbf{Var}}", binset: "\\{0,1\\}", inprod: ["\\langle #1 \\rangle",1], } } }; </script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script><html lang="ja"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/nobunote/assets/css/just-the-docs-default.css"><link rel="stylesheet" href="/nobunote/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"><style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(2)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(2) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(3) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(2) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list { display: block; }</style><script src="/nobunote/assets/js/vendor/lunr.min.js"></script> <script src="/nobunote/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/nobunote/favicon.ico" type="image/x-icon"><title>ペア独立性 | NobuNote</title><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="ペア独立性" /><meta property="og:locale" content="en_US" /><meta name="description" content="Private Note of Nobutaka Shimizu" /><meta property="og:description" content="Private Note of Nobutaka Shimizu" /><link rel="canonical" href="http://localhost:4000/nobunote/docs/tools/pairwise_independent/" /><meta property="og:url" content="http://localhost:4000/nobunote/docs/tools/pairwise_independent/" /><meta property="og:site_name" content="NobuNote" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ペア独立性" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Private Note of Nobutaka Shimizu","headline":"ペア独立性","url":"http://localhost:4000/nobunote/docs/tools/pairwise_independent/"}</script><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg><div class="side-bar"><div class="site-header" role="banner"> <a href="/nobunote/" class="site-title lh-tight"> NobuNote </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="/nobunote/" class="nav-list-link">Home</a><li class="nav-list-item"><a href="/nobunote/docs/notation/" class="nav-list-link">よく使う記号</a><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in よく使う道具 category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/nobunote/docs/tools/" class="nav-list-link">よく使う道具</a><ul class="nav-list"><li class="nav-list-item"><a href="/nobunote/docs/tools/concentration/" class="nav-list-link">確率集中不等式</a><li class="nav-list-item"><a href="/nobunote/docs/tools/pairwise_independent/" class="nav-list-link">ペア独立性</a><li class="nav-list-item"><a href="/nobunote/docs/tools/expander/" class="nav-list-link">エクスパンダーグラフ</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Learning with Error category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/nobunote/docs/learning_with_error/" class="nav-list-link">Learning with Error</a><ul class="nav-list"><li class="nav-list-item"><a href="/nobunote/docs/learning_with_error/BKW%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0/" class="nav-list-link">BKWアルゴリズム</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in 埋め込みクリーク問題 category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/nobunote/docs/planted_clique/" class="nav-list-link">埋め込みクリーク問題</a><ul class="nav-list"><li class="nav-list-item"><a href="/nobunote/docs/planted_clique/Kurera%E3%81%AE%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0/Kucera%E3%81%AE%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0/" class="nav-list-link">Kučeraのアルゴリズム</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in 平均時計算量 category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/nobunote/docs/average_case_complexity/" class="nav-list-link">平均時計算量</a><ul class="nav-list"><li class="nav-list-item"><a href="/nobunote/docs/average_case_complexity/Goldreich-Levin/" class="nav-list-link">Goldreich-Levinの定理</a></ul></ul></nav><footer class="site-footer"> This is a private note by Nobutaka Shimizu.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search" role="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search NobuNote" aria-label="Search NobuNote" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="https://sites.google.com/view/nobutaka-shimizu/home" class="site-button" > 製作者: 清水 伸高 </a></ul></nav></div><div class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/nobunote/docs/tools/">よく使う道具</a><li class="breadcrumb-nav-list-item"><span>ペア独立性</span></ol></nav><div id="main-content" class="main-content"><main><h1 id="確率変数族のペア独立性"> <a href="#確率変数族のペア独立性" class="anchor-heading" aria-labelledby="確率変数族のペア独立性"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 確率変数族のペア独立性</h1><p>確率変数族の<strong>ペア独立性 (pairwise independence)</strong>は計算量理論の文脈では Goldreich-Levinの定理, set lower bound protocol, ハッシュ関数, 擬似ランダム生成器などの文脈でよく使われるテクニックです. 通常の意味での独立性を緩めた概念であり, 少ないランダムネスを用いて多くの確率変数を生成する手法としては典型的なものとなります.</p><p>確率変数の列$(X_1,\dots,X_n)$が独立であるというのは「いくつかの$i$に対し$X_i=x_i$である」という事象が他の確率変数の分布に影響を与えないこととされます. ここでは今後の比較のために, 確率変数族の独立性を以下の形で定義しておきます:</p><blockquote class="definition-title"><p><strong>定義 (独立性)</strong></p><p>確率変数の列$(X_1,\dots,X_n$)が<strong>独立である</strong>とは, 任意のインデックスの部分集合$I= \{i_1,\dots,i_k\}\subseteq [n]$と$x_{i_1},\dots,x_{i_k}$に対して以下が成り立つことである:</p>\[\begin{align*} \Pr \left[ X_{i_1} = x_{i_1}\text{ and }\dots\text{ and }X_{i_k} = x_{i_k} \right] = \prod_{j\in[k]} \Pr[X_{i_j}=x_{i_j}]. \tag{1} \end{align*}\]</blockquote><p>ペア独立性とは, 式(1)が成り立つ部分集合$I$の範囲を任意の部分集合ではなく要素数$2$の部分集合に制限することによって定まる概念です.</p><blockquote class="definition-title"><p><strong>定義 (ペア独立性)</strong></p><p>確率変数の列$(X_1,\dots,X_n$)が<strong>ペア独立である</strong>とは, 任意の要素数$2$のインデックスの部分集合$0\le i &lt; j \le n$と$x_i,x_j$に対して以下が成り立つことである:</p>\[\begin{align*} \Pr \left[ \begin{aligned} X_{i} &amp;= x_{i} \\ X_{j} &amp;= x_{j} \end{aligned} \right] = \Pr[X_{i}=x_{i}]\cdot \Pr[X_j = x_j]. \tag{2} \end{align*}\]</blockquote><h2 id="例1"> <a href="#例1" class="anchor-heading" aria-labelledby="例1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 例1</h2><p>$X_1,\dots,X_n$を独立で$\{0,1\}$上一様ランダムな確率変数とし, 各$1\le i &lt; j \le n$に対して</p>\[\begin{align*} Y_{ij} = X_i + X_j \bmod 2 \end{align*}\]<p>で定まる確率変数族$(Y_{ij})_{1\le i&lt;j\le n}$はペア独立です.</p><details style="background-color: #eee;"> <summary style="display: list-item">証明</summary><p>簡単のため$n=3$で考えます (一般の$n$についても同様). 任意の$y_{12},y_{23}\in \{0,1\}$に対して</p>\[\begin{align*} \Pr\left[ \begin{aligned} Y_{12}&amp;=y_{12} \\ Y_{23}&amp;=y_{23} \end{aligned} \right] &amp;= \Pr\left[ \begin{aligned} X_1+X_2&amp;=y_{12} \pmod 2 \\ X_2+X_3&amp;=y_{23} \pmod 2 \end{aligned} \right] \\ &amp;= \Pr\left[ \begin{aligned} X_1 &amp;= y_{12} + X_2 \pmod 2 \\ X_3 &amp;= y_{23} + X_2 \pmod 2 \end{aligned} \right] \\ &amp;= \frac{1}{4} \\ &amp;= \Pr[Y_{12}=y_{12}]\cdot \Pr[Y_{23}=y_{23}] \end{align*}\]<p>を得ます. 三つ目の等式では$X_1,X_2,X_3$の独立性を用いています.</p></details><blockquote class="remark"><p>上記の例で$n$ビットのランダムな文字列$(X_1,\dots,X_n) \sim \{0,1\}^n$を$\binom{n}{2}$ビットの文字列$(Y_{ij})$\に変換しています (ただし変換で文字列を延ばす代わりに各ビットの独立性は損なわれるため, 得られる長い文字列を擬似ランダム文字列と呼ぶ). このように, <strong>ペア独立性の技法を用いると少ないエントロピーのランダムネスから長い擬似ランダム文字列を生成</strong>できます (このアイデアはより一般に擬似ランダム生成器の概念で一般化されます). 例えばこのように生成された長い擬似ランダム文字列を乱択アルゴリズムのランダムシードとして代用することでより少ないランダムネスを用いた乱択アルゴリズムの模倣が可能になります. この模倣の精度をペア独立性を用いて評価していくことになります.</p></blockquote><h2 id="例2-ランダムビットの線形結合"> <a href="#例2-ランダムビットの線形結合" class="anchor-heading" aria-labelledby="例2-ランダムビットの線形結合"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 例2. ランダムビットの線形結合</h2><p>例1と同様に独立に$X_1,\dots,X_n \sim \{0,1\}$を選びます. 例1では$X_i + X_j$という形を考えていましたが, より一般に$X_{i_1}+\dots + X_{i_k}$という形を考えてもペア独立性が保たれることが同様にして証明できます. 非空な部分集合$I \subseteq [n]$に対して</p>\[\begin{align*} Y_I = \sum_{i\in I} X_i \bmod 2 \end{align*}\]<p>とすることによって定まる確率変数族$(Y_I)_{I\ne \emptyset}$はペア独立性を持つ.</p><details style="background-color: #eee;"> <summary style="display: list-item">証明</summary><p>任意の非空な$I \subseteq[n]$に対して, $X_1,\dots,X_n\sim \{0,1\}$が独立一様ランダムなので, $Y_I$の周辺分布も$\{0,1\}$上で一様となります. また, 相異なる二つの非空な部分集合$I,J\subseteq[n]$および$a,b \in \{0,1\}$に対して</p>\[\begin{align*} \Pr \left[ \begin{aligned} Y_I &amp;= a \\ Y_J &amp;= b \end{aligned} \right] &amp;= \Pr \left[ \begin{aligned} Y_{I\setminus J} + Y_{I\cap J} &amp;= a \\ Y_{J\setminus I} + Y_{I\cap J} &amp;= b \end{aligned} \right] \\ &amp;= \Pr \left[ \begin{aligned} Y_{I\setminus J} &amp;= a - Y_{I\cap J} \\ Y_{J\setminus I} &amp;= b - Y_{I\cap J} \end{aligned} \right] \\ &amp;= \frac{1}{4} \end{align*}\] <details style="background-color: #eee;"> <summary style="display: list-item">証明</summary> </details><p>より, 確かにペア独立性を満たします. ここで最後の等式では, $X_i$たちの独立性より, $Y_{I\setminus J}$と$Y_{J\setminus I}$が独立であることを用いています ($I\ne J$より$I\setminus J$と$J\setminus I$はどちらも非空であることに注意). $\square$</p></details><p>この方法を用いると$n$ビットのエントロピーから長さ$2^n-1$の擬似ランダム文字列を得られるので, 指数的に長さを延ばすことが可能となります.</p><h3 id="ランダム線形関数としての視点"> <a href="#ランダム線形関数としての視点" class="anchor-heading" aria-labelledby="ランダム線形関数としての視点"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ランダム線形関数としての視点</h3><p>例2の構成で得られる$(Y_I)_{I\ne \emptyset}$は, 一様ランダムなベクトル$c \sim \mathbb{F}_2^n$に対して線形関数$z \mapsto \inprod{c,z}$を考えて その($0$以外での)真理値表としてみなすことができます. この解釈は <a href="/nobunote/docs/average_case_complexity/Goldreich-Levin">Goldreich-Levinの定理</a> の証明において本質的に効いてきます.</p><h2 id="例3-ランダムな直線"> <a href="#例3-ランダムな直線" class="anchor-heading" aria-labelledby="例3-ランダムな直線"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 例3. ランダムな直線</h2><p>要素数$q$の有限体$\mathbb{F}_q$に対して一様ランダムに$a,b\sim \mathbb{F}_q$を選び, 各$i\in \mathbb{F}_q$に対して</p>\[\begin{align*} X_i = a i + b \end{align*}\]<p>として確率変数族$(X_i)_{i\in \mathbb{F}_q}$を定めると$(X_i)$はペア独立です.</p><details style="background-color: #eee;"> <summary style="display: list-item">証明</summary><p>任意の相異なる$\mathbb{F}_q$の元$i,j$および$c,d \in \mathbb{F}_q$に対して</p>\[\begin{align*} \Pr \left[ \begin{aligned} X_i &amp;= c \\ X_j &amp;= d \end{aligned} \right] &amp;= \Pr_{a,b\sim \mathbb{F}_q} \left[ \begin{aligned} ai+b &amp;= c \\ aj+b &amp;= d \end{aligned} \right] \\ &amp;= \Pr_{a,b\sim \mathbb{F}_q} \left[ \begin{bmatrix} i &amp; 1 \\ j &amp; 1 \end{bmatrix} \begin{bmatrix} a \\ b \end{bmatrix} = \begin{bmatrix} c \\ d \end{bmatrix} \right] \end{align*}\]<p>ここで, $i\ne j$より行列</p>\[\begin{align*} \begin{bmatrix} i &amp; 1 \\ j &amp; 1 \end{bmatrix} \end{align*}\]<p>は逆行列を持つ (Vandermonde行列の特殊ケース) ので, 最後の等式の確率の中身は$a=\ast,b=\ast$の形で書けます. $a,b$は一様ランダムなので, この確率は$1/q^2$です. 一方で, ランダムな$a,b\sim \mathbb{F}_q$と固定した$i\in \mathbb{F}_q$に対し$X_i=ai+b$の周辺分布は$\mathbb{F}_q$上一様なので, 確かに$(X_i)$はペア独立です.</p></details><p>ランダムな直線に基づく生成はランダムな$a,b\sim \mathbb{F}_q$を受け取って$q$個の$\mathbb{F}_q$の元を出力しています.</p></main><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2024 Nobutaka Shimizu. <a href="https://docs.github.com/ja/pages/getting-started-with-github-pages/about-github-pages">This site is powered by Github Pages.</a></p><div class="d-flex mt-2"></div></footer></div></div><div class="search-overlay"></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>
