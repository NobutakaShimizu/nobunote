<!DOCTYPE html> <script> window.MathJax = { loader: { load: ['[tex]/physics', '[tex]/mathtools'] }, tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [ ['$$','$$'], ["\\[","\\]"] ], packages: {'[+]': ['physics','mathtools']}, macros: { Nat: "{\\mathbb{N}}", Real: "{\\mathbb{R}}", Comp: "\\mathbb{C}", Int: "\\mathbb{Z}", F: "\\mathbb{F}", poly: "\\mathrm{poly}", polylog: "\\mathrm{polylog}", SIZE: "\\mathrm{SIZE}", maj: "\\mathsf{maj}", E: "{\\operatorname*{\\mathbb{E}}}", Var: "{ \\operatorname*{\\mathbf{Var}} }", condition: "\\;\\middle\\vert\\;}", Bin: "\\mathrm{Bin}", indicator: "\\mathbf{1}", binset: "\\{0,1\\}", inprod: ["\\langle #1 \\rangle",1], supp: "\\mathsf{supp}", dist: "\\mathrm{dist}", if: "\\text{if }", and: "\\text{ and }", or: "\\text{ or }", otherwise: "\\text{otherwise}", tinyforall: "{}^{\\forall}", tinyexists: "{}^{\\exists}", calA: "\\mathcal{A}", calB: "\\mathcal{B}", calC: "\\mathcal{C}", calD: "\\mathcal{D}", calE: "\\mathcal{E}", calF: "\\mathcal{F}", calG: "\\mathcal{G}", calH: "\\mathcal{H}", calI: "\\mathcal{I}", calJ: "\\mathcal{J}", calK: "\\mathcal{K}", calL: "\\mathcal{L}", calM: "\\mathcal{M}", calN: "\\mathcal{N}", calO: "\\mathcal{O}", calP: "\\mathcal{P}", calQ: "\\mathcal{Q}", calR: "\\mathcal{R}", calS: "\\mathcal{S}", calT: "\\mathcal{T}", calU: "\\mathcal{U}", calV: "\\mathcal{V}", calW: "\\mathcal{W}", calX: "\\mathcal{X}", calY: "\\mathcal{Y}", calZ: "\\mathcal{Z}", Atilde: "\\widetilde{A}", Ctilde: "\\widetilde{C}", PC: "\\mathsf{PC}", } } }; </script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script><html lang="ja"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/nobunote/assets/css/just-the-docs-default.css"><link rel="stylesheet" href="/nobunote/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"><style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(3)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(5) > ul > li:nth-child(3) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(5) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(5) > ul > li:nth-child(3) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(5) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(5) > ul.nav-list > li.nav-list-item:nth-child(3) > ul.nav-list { display: block; }</style><script src="/nobunote/assets/js/vendor/lunr.min.js"></script> <script src="/nobunote/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/nobunote/favicon.ico" type="image/x-icon"><title>ハードコア補題 | NobuNote</title><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="ハードコア補題" /><meta property="og:locale" content="en_US" /><meta name="description" content="Private Note of Nobutaka Shimizu" /><meta property="og:description" content="Private Note of Nobutaka Shimizu" /><link rel="canonical" href="http://localhost:4000/nobunote/docs/average_case_complexity/hardcore/" /><meta property="og:url" content="http://localhost:4000/nobunote/docs/average_case_complexity/hardcore/" /><meta property="og:site_name" content="NobuNote" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ハードコア補題" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Private Note of Nobutaka Shimizu","headline":"ハードコア補題","url":"http://localhost:4000/nobunote/docs/average_case_complexity/hardcore/"}</script><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg><div class="side-bar"><div class="site-header" role="banner"> <a href="/nobunote/" class="site-title lh-tight"> NobuNote </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="/nobunote/" class="nav-list-link">Home</a><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in よく使う道具 category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/nobunote/docs/tools/" class="nav-list-link">よく使う道具</a><ul class="nav-list"><li class="nav-list-item"><a href="/nobunote/docs/tools/notation/" class="nav-list-link">記法</a><li class="nav-list-item"><a href="/nobunote/docs/tools/prob_inequalities/" class="nav-list-link">よく使う不等式</a><li class="nav-list-item"><a href="/nobunote/docs/tools/pairwise_independent/" class="nav-list-link">ペア独立性</a><li class="nav-list-item"><a href="/nobunote/docs/tools/expander/" class="nav-list-link">エクスパンダーグラフ</a><li class="nav-list-item"><a href="/nobunote/docs/tools/random_graph/" class="nav-list-link">ランダムグラフ</a><li class="nav-list-item"><a href="/nobunote/docs/tools/sampler/" class="nav-list-link">サンプラー</a><li class="nav-list-item"><a href="/nobunote/docs/tools/spectra/" class="nav-list-link">行列のスペクトル</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Learning with Error category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/nobunote/docs/learning_with_error/" class="nav-list-link">Learning with Error</a><ul class="nav-list"><li class="nav-list-item"><a href="/nobunote/docs/learning_with_error/BKW%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0/" class="nav-list-link">BKWアルゴリズム</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in 埋め込みクリーク問題 category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/nobunote/docs/planted_clique/" class="nav-list-link">埋め込みクリーク問題</a><ul class="nav-list"><li class="nav-list-item"><a href="/nobunote/docs/planted_clique/Kucera%E3%81%AE%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0/" class="nav-list-link">Kučeraのアルゴリズム</a><li class="nav-list-item"><a href="/nobunote/docs/planted_clique/AKS%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0/" class="nav-list-link">AKSアルゴリズム</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in 平均時計算量理論 category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/nobunote/docs/average_case_complexity/" class="nav-list-link">平均時計算量理論</a><ul class="nav-list"><li class="nav-list-item"><a href="/nobunote/docs/average_case_complexity/average_case_hardness/" class="nav-list-link">問題の平均時困難性</a><li class="nav-list-item"><a href="/nobunote/docs/average_case_complexity/Yao_XOR/" class="nav-list-link">XOR補題</a><li class="nav-list-item"><a href="/nobunote/docs/average_case_complexity/hardcore/" class="nav-list-link">ハードコア補題</a><li class="nav-list-item"><a href="/nobunote/docs/average_case_complexity/Goldreich-Levin/" class="nav-list-link">Goldreich-Levinの定理</a></ul></ul></nav><footer class="site-footer"> This is a private note by Nobutaka Shimizu.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search" role="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search NobuNote" aria-label="Search NobuNote" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="https://sites.google.com/view/nobutaka-shimizu/home" class="site-button" > 製作者: 清水 伸高 </a></ul></nav></div><div class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/nobunote/docs/average_case_complexity/">平均時計算量理論</a><li class="breadcrumb-nav-list-item"><span>ハードコア補題</span></ol></nav><div id="main-content" class="main-content"><main><h1 id="ハードコア補題"> <a href="#ハードコア補題" class="anchor-heading" aria-labelledby="ハードコア補題"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ハードコア補題</h1><p>ハードコア補題とは <a href="https://ieeexplore.ieee.org/document/492584">Impagliazzo (1995)</a>の結果で, <a href="/nobunote/docs/average_case_complexity/Yao_XOR">XOR補題</a>など平均時計算量の様々な定理の証明に用いることができる非常に便利な定理です.</p><p>サイズ$s$以下の回路全体の集合を$\SIZE(s)$とします. 部分集合$H\subseteq\binset^n$は$|H|\ge \delta 2^n$を満たすとき<strong>$\delta$-密</strong>であると呼ぶことにします.</p><div id="hardcore-set"><blockquote class="theorem-title"><p><strong>定理 (ハードコア補題)</strong></p><p>任意の$\delta,\varepsilon&gt;0$および$s\le 2^{o(n)}$に対して以下が成り立つ: 関数$f\colon \binset^n\to\binset$がサイズ$s$に対して$\delta$-困難ならば, ある$\delta$-密な集合$H\subseteq\binset^n$と十分小さな定数$c&gt;0$が存在して, 全ての回路$C \in \SIZE(c\delta^2\varepsilon^2 s)$に対して</p>\[\begin{align*} \Pr_{x\sim H}\left[ C(x) = f(x) \right] \le \frac{1}{2} + \varepsilon. \end{align*}\]</blockquote></div><p>弱い平均時困難性を持つ任意の関数$f$では, 任意の小さい回路はそこそこの割合の入力で誤った値を出力しますが, ハードコア補題はその関数$f$の困難性を凝縮したような入力部分集合$H\subset\binset^n$が存在して, $H$上では$f(x)$の計算が非常に困難になります. このような$H$を<strong>ハードコア集合</strong>といいます.</p><p align="center"><img src="/nobunote/docs/average_case_complexity/images/hardcore_image.svg" alt="ハードコア補題のイメージ" /></p><p>ハードコア補題はブースティングに基づく証明とvon-Neumannのminimax定理に基づく証明の二通りの証明が有名ですが, ここでは前者の証明を解説します.</p><h2 id="概要"> <a href="#概要" class="anchor-heading" aria-labelledby="概要"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 概要</h2><p>対偶を証明します. つまり, 任意の$\delta$-密な部分集合$H\subseteq \binset^n$に対してあるサイズ$s_0$の回路$C_H$が存在して</p>\[\begin{align*} \Pr_{x\sim H} \left[ C_H(x) = f(x) \right] \ge \frac{1}{2} + \varepsilon \tag{1} \end{align*}\]<p>を満たすならば, あるサイズ$O(s_0\cdot \delta^{-2}\varepsilon^{-2})$の回路$C’$が存在して</p>\[\begin{align*} \Pr_{x\sim\binset^n} \left[ C'(x) = f(x) \right] \ge 1-\delta \end{align*}\]<p>を満たすことを示します.</p><p>実は所望の回路$C’$は幾つかの$\delta$-密な部分集合$H_1,\dots,H_\ell\subseteq\binset^n$を選び, それぞれに対し(1)を満たす回路$C_{H_1},\dots,C_{H_\ell}$の出力値の多数決を出力する回路となります (ここで$\ell=O(\delta^{-2}\delta^{-2})$). それぞれの回路$C_{H_1},\dots,C_{H_\ell}$のサイズは高々$s_0$なので最終的な回路$C’$のサイズは$O(s_0\cdot \delta^{-2}\varepsilon^{-2})$で上から抑えられます.</p><p>以下ではそれらの$H_1,\dots,H_\ell$を選ぶアルゴリズムを記述します. 強調しておきますが, <strong>このアルゴリズムの計算量は最終的な回路$C’$の複雑性に影響を与えません</strong>. どのように$H_1,\dots,H_\ell$を選んでも最終的に得られる回路$C’$のサイズは$O(s_0\cdot \ell)$です.</p><blockquote class="remark"><p>イメージとしては, 局所的($H$上)にそこそこ$f$の値を推測できる機械があったとき, それらをうまく繋げて大域的($\binset^n$上)に$f$を高精度で計算せよ, という問題を考えています. このように弱い学習器をうまく用いて強い学習器を構成する方法を機械学習の分野では<strong>ブースティング(boosting)</strong>と呼びます.</p></blockquote><h2 id="準備"> <a href="#準備" class="anchor-heading" aria-labelledby="準備"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 準備</h2><p>証明を述べるためにいくつかの概念を導入します. 部分集合$H\subseteq \binset^n$の指示関数を$\indicator_H\colon\binset^n\to\binset$と表し, 値域を$\binset$から$[0,1]$に緩和した関数</p>\[\begin{align*} M\colon \binset^n\to[0,1] \end{align*}\]<p>を<strong>測度(measure)</strong>と呼びます. 集合のサイズ$\abs{H}=\sum_{x\in\binset^n}\indicator_H(x)$の類推で測度のサイズを$\abs{M}=\sum_{x\in\binset^n}M(x)$で定義し, 密度を$\frac{\abs{M}}{2^n}$で定義します. 密度が$\delta$以上であるような測度$M$は<strong>$\delta$-密</strong>であるといいます. 特に, $M=\indicator_H$が部分集合$H$の指示関数であるとき, $\indicator_H$と$H$の$\delta$-密性は一致します.</p><p>正の密度を持つ測度$M$に付随する$\binset^n$上の分布$\calL_M$を</p>\[\begin{align*} \Pr_{x\sim \calL_M}[ x = a] = \frac{M(a)}{\abs{M}} \end{align*}\]<p>で定めます. 例えば$M=\indicator_H$と表せるとき, $\calL_M$は$H$上の一様分布と一致します.</p><h2 id="ステップ1-ブースティング"> <a href="#ステップ1-ブースティング" class="anchor-heading" aria-labelledby="ステップ1-ブースティング"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ステップ1. ブースティング</h2><p>ハードコア補題では任意の$\delta$-密な集合$H$上である程度$f$を計算する回路$C_H$の存在性を仮定していましたが, まず最初にハードコア補題の主張において集合を測度に緩めた次の主張を証明します.</p><div id="hardcore-measure"><blockquote class="lemma-title"><p><strong>補題(ハードコア測度).</strong></p><p>任意の$\delta,\varepsilon&gt;0$に対して以下が成り立つ: 関数$f\colon \binset^n\to\binset$がサイズ$s$に対して$\delta$-困難ならば, ある$\delta$-密な測度$M\colon \binset^n\to[0,1]$と十分小さな定数$c&gt;0$が存在して, 全ての回路$C \in \SIZE(c\delta^2\varepsilon^2 s)$に対して</p>\[\begin{align*} \Pr_{x\sim \calL_M}\left[ C(x) = f(x) \right] \le \frac{1}{2} + \varepsilon. \end{align*}\]</blockquote></div><p>対偶を証明します. 任意の$\delta$-密な測度$M$に対してあるサイズ$s$の回路$C_M$が存在して</p>\[\begin{align*} \Pr_{x\sim \calL_M} \left[ C_M(x) = f(x) \right] \ge \frac{1}{2} + \varepsilon \tag{2} \end{align*}\]<p>が成り立つとします. 以下の手続きに従って回路の列$C_1,C_2,\dots$を定義していきます:</p><blockquote class="corollary-title"><p><strong>ブースティングアルゴリズム</strong></p><ol><li>測度$M_1$を$M_1\equiv 1$ (定数関数) とし, $i=1$とする.<li><p>測度$M_i$が$\delta$-密でないならば終了する. そうでなければ, 各$x\in\binset^n$と$j\le i$に対して$b_j(x)\in\binset$を以下で定める:</p>\[\begin{align*} b_j(x) = \begin{cases} \tag{3} 1 &amp; \if C_{j}(x)= f(x),\\ -1 &amp; \if C_{j}(x) \ne f(x). \end{cases} \end{align*}\]<p>ここで$C_j=C_{M_j}$は測度$M=M_j$に対して(2)を満たす回路である. また, $R_i(x) = \sum_{j\le i}b_j(x)$をインスタンス$x$におけるこれまでの得失点とする.</p><li><p>パラメータ$\gamma:=\delta\varepsilon$に対して次の測度$M_{i+1}$を以下で定める:</p>\[\begin{align*} M_{i+1}(x) = \begin{cases} \tag{4} 1 &amp; \if R_i(x)\le 0,\\ 1-\gamma R_i(x) &amp; \if 0&lt;R_i(x)&lt;1/\gamma,\\ 0 &amp; \if R_i(x)\ge 1/\gamma. \end{cases} \end{align*}\]<p>その後, $i\leftarrow i+1$に更新し, ステップ2に戻る.</p></ol></blockquote><p align="center"><img src="/nobunote/docs/average_case_complexity/images/hardcore_boosting.svg" alt="測度の更新" /></p><p>イメージとしては, $i$に関する各反復において, これまで選んできた回路$C_1,\dots,C_i$にとって「苦手な」インスタンスが選ばれ易くなるように次の測度$M_{i+1}$を選んでいます. 実際, 得失点$R_i(x)$が小さい(すなわち$C_1,\dots,C_i$にとって$x$が「苦手な」インスタンスである)場合, $M_{i+1}(x)$は大きい値をとりやすいです.</p><p>上の手続きによって得られる回路を$C_1,\dots,C_\ell$とし,</p>\[\begin{align*} C' = \maj(C_1,\dots,C_\ell) \tag{5} \end{align*}\]<p>とします. まず, 各$C_i$のサイズが高々$s_0$なので回路$C’$のサイズは高々$O(\ell s_0)$となります (多数決$\maj$は入力の個数に関する線形サイズの回路で実装できる).</p><p>まず回路$C’$の性能を評価します.</p><div id="boosting-performance"><blockquote class="lemma"><p>ブースティングアルゴリズムによって得られた回路$C_1,\dots,C_\ell$に対して(5)で得られる回路$C’$は</p>\[\begin{align*} \Pr_{x\sim\binset^n} \left[ C'(x) = f(x)\right] \ge 1-\delta \end{align*}\]<p>を満たす.</p></blockquote></div><details style="background-color: #eee;"> <summary style="display: list-item">証明</summary><p>インスタンス$x\in\binset^n$に対して$C’(x)\ne f(x)$とすると, $C_1,\dots,C_\ell$のうち少なくとも$\ell/2$個の回路は入力$x$に対して間違えた値を出力するはずです. 従って$R_\ell(x)\le 0$となるので, $M_{\ell+1}(x)=1$となります. 一方で, ブースティングアルゴリズムはステップ2において$i=\ell+1$のとき終了するはずなので, $M_{\ell+1}$は$\delta$-密でない, すなわち$\E[M_{\ell+1}]&lt; \delta$となります. 一方で</p>\[\begin{align*} \delta &amp;&gt; \E[M_{\ell+1}] \\ &amp;= 2^{-n}\sum_{x\in\binset^n} M_{\ell+1}(x) \\ &amp;\ge 2^{-n} \abs*{ \left\{x\in\binset^n\colon C'(x)\ne f(x)\right\} } \\ &amp;=\Pr_{x\sim\binset^n} \left[C'(x)\ne f(x)\right] \end{align*}\]<p>より主張を得ます.</p></details><p>最後に$\ell$の上界を評価します. ここが証明のうち最も技巧的な部分です.</p><div id="boosting-size"><blockquote class="lemma"><p>ブースティングアルゴリズムで得られる回路の個数は高々$O(\delta^{-2}\varepsilon^{-2})$である.</p></blockquote><details style="background-color: #eee;"> <summary style="display: list-item">証明</summary><p>不変量</p>\[\begin{align*} \Phi = \sum_{i\in[\ell]}\sum_{x\in\binset^n} M_i(x) b_i(x) \end{align*}\]<p>の上下界をそれぞれ求めます. ここで$b_j(x)$は式(3)で定義される関数です.</p><p>まず, 各$i\in[\ell]$に対して$C_i$に関する仮定(2)より</p>\[\begin{align*} \E_{x\sim\calL_{M_i}} \left[ b_i(x) \right] &amp;= \Pr_{x\sim\calL_{M_i}} \left[C_i(x) = f(x)\right] - \Pr \left[ C_i(x) \ne f(x)\right] \\ &amp;= 2\Pr \left[C_i(x) = f(x)\right] - 1 \\ &amp;\ge 2\varepsilon \end{align*}\]<p>より, 両辺の$i\sim[\ell]$について総和をとると</p>\[\begin{align*} \Psi &amp;= \sum_{i\in[\ell]} \abs{M_i}\cdot\E_{x\sim\calL_{M_i}} [b_i(x)] \\ &amp;\ge \sum_{i\in[\ell]} \delta 2^n\cdot 2\varepsilon &amp; &amp; \because\text{各$M_i$は$\delta$-密} \\ &amp;= 2\ell\delta\varepsilon\cdot 2^n. \tag{6} \end{align*}\]<p>次にインスタンス$x\in\binset^n$を固定して$\sum_{i\in[\ell]}M_i(x)b_i(x)$を上から抑えます. 関数$m\colon \Int\to[0,1]$を</p>\[\begin{align*} m(z) = \begin{cases} 1 &amp; \if z\le 0,\\ 1-\gamma z &amp; \if 0&lt;z&lt;1/\gamma,\\ 0 &amp; \if z\ge1/\gamma \end{cases} \end{align*}\]<p>とします. つまり, 測度$M_i$の更新式(4)を$M_{i+1}(x) = m(R_i(x))$と表します.</p><p>ここで, 次の補助的な有向路を考えます:</p><ul><li>頂点集合は$\{ R_i(x)\colon i=0,1,\dots,\ell\} \subseteq\Int$ (ただし$R_0(x)=0$と定める).<li>各$i\in[\ell]$に対してこの有向路は有向辺$(R_{i-1}(x),R_{i}(x))$をこの順番で辿る. さらに, $i$番目の辺を辿ったときに重み$M_{i}(x)b_i(x)$を課す.</ul><p>要するに, 新たに選んだ回路$C_i$がインスタンス$x$上で$f(x)$を計算できたら右側, そうでなければ左側に移動する路を考えています. この有向路が課される重みの総和</p>\[\begin{align*} \sum_{i\in[\ell]} M_{i}(x) b_{i}(x) \tag{7} \end{align*}\]<p>を上から評価すれば$\Phi$の上界に繋がります.</p><p align="center"><img src="/nobunote/docs/average_case_complexity/images/hardcore_proof_path.svg" alt="path" /></p><ul><li><p>まず, 頂点$a=R_{i-1}(x)\ge 1/\gamma$から出発する辺についてはその重みの絶対値は$M_i(x)=m(R_{i-1}(x))=0$となるため, 総和に寄与しません.</p><li><p>次に, 有向パスが辺$(a,a+1)$と$(a+1,a)$を辿ったとします. 辺$(a,a+1)$に課される重みとその逆順$(a+1,a)$に課される重みは符号が異なっており, これら二つの和の絶対値は適当な$a\in\Int$を用いて$\abs{m(a)-m(a+1)}$と表せます. 関数$m$は$0&lt;a&lt;1/\gamma$の範囲では傾き$\gamma$, それ以外では傾き$0$の直線なので, この絶対値は高々$\gamma$となります. このような往復のペアは有向路全体の中でも高々$\ell/2$個しかないので, 往復に課される重みの総和(7)に対する寄与は高々$\gamma\ell/2$となります.</p><li><p>有向路から全ての往復を除去すると, 閉路がなくなるため単なるパスとなります. 左に行き続ける有向路$0\to -1 \to -2\to \dots$については辺重みが$0$以下なので, 総和(7)に寄与しません. 一方で下図のように右に行き続ける有向路$0\to 1\to 2\to \dots$は, 座標$\ge1/\gamma$から出発する辺の重みは$0$になるので, 総和(7)に寄与する部分の路長は高々$1/\gamma$です. 重みは常に$1$以下であることを踏まえると, このパス全体の寄与は高々$1/\gamma$となります.</p></ul><p align="center"><img src="/nobunote/docs/average_case_complexity/images/hardcore_proof_path2.svg" alt="path" /></p><p>以上の議論より, 総和(7)は高々$\frac{\gamma\ell}{2} + \frac{1}{\gamma}$となり, これは任意のインスタンス$x$について成り立つことから</p>\[\begin{align*} \Phi \le 2^n\cdot \left(\frac{\gamma\ell}{2} + \frac{1}{\gamma}\right) \tag{8} \end{align*}\]<p>を得ます.</p><p>最後に, (6)(8)を$\ell$について解くと$\ell=O(\delta^{-2}\varepsilon^{-2})$を得ます. $\square$</p></details></div><p>以上よりハードコア測度の補題を証明できます.</p><details style="background-color: #eee;"> <summary style="display: list-item"> <a href="#hardcore-measure">ハードコア測度補題</a> の証明</summary><p>関数$f$が$\SIZE(s)$に対して$\delta$-困難であるとし, 任意の$\delta$-密な測度$M$に対して(2)を満たす回路$C_M$が存在し, そのサイズは$c\delta^2\varepsilon^2 s$となることを(背理法として)仮定します (ここで$c&gt;0$は十分小さな定数).</p><p>ブースティングアルゴリズムによって得られる回路$C_1,\dots,C_\ell$は, 各$C_i$のサイズが高々$c\delta^2\varepsilon^2 s$なので, (5)で定義される$C’$のサイズは, 二つ目の補題より高々$O(s\ell)=O(s\delta^{-2}\varepsilon^{-2}) \le s$となります (最後の不等号では$c$が十分小さい定数であることを用いた). 一方, 最初の補題より, $C’$は$\Pr_{x\sim\binset^n}[C’(x)=f(x)] \ge 1-\delta$となり, 関数$f$が$\SIZE(s)$に対して$\delta$-困難であることに矛盾します. $\square$</p></details><h2 id="ステップ2-ハードコア測度からハードコア集合へ"> <a href="#ステップ2-ハードコア測度からハードコア集合へ" class="anchor-heading" aria-labelledby="ステップ2-ハードコア測度からハードコア集合へ"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ステップ2: ハードコア測度からハードコア集合へ</h2><p><a href="#hardcore-measure">ハードコア測度補題</a> ではハードコア測度の存在性を示しましたが, これを確率論的手法に基づいて離散化してハードコア集合の存在性を簡単に証明できます.</p><details style="background-color: #eee;"> <summary style="display: list-item"> <a href="#hardcore-set">ハードコア補題</a>の証明 </summary><p>ハードコア測度補題により存在性が保証されるハードコア測度を$M$とします. この測度$M\colon\binset^n\to[0,1]$は$\delta$-密であり, (十分小さな定数$c&gt;0$に対して)任意のサイズ$c\delta^2\varepsilon^2 s$の回路$C$に対して</p>\[\begin{align*} \Pr_{x\sim\calL_M} \left[C(x) = f(x)\right] \le \frac{1}{2} + \varepsilon \end{align*}\]<p>を満たします.</p><p>集合$H\subseteq\binset^n$を, 各$x\in\binset^n$に対して独立に確率$M(x)\in[0,1]$で$H$に含めて得られるランダムな集合とします. このランダムな集合$H$が正の確率で所望の性質を満たすことを示すことによって, 所望の集合の存在性を証明します.</p><p><strong>密性の証明</strong></p><p>ランダム集合$H$の要素数の期待値は \(\E[\abs{H}]=\sum_{x\in\binset^n} M(x) = \abs{M}\ge \delta\) であり, $\abs{H}=\sum_{x\in\binset^n} \indicator_{x\in H}$は独立な確率変数の和なので, <a href="/nobunote/docs/tools/prob_inequalities#hoeffding-inequality">Hoeffdingの不等式</a>より確率$0.99$で$\abs{H}\ge (1-o(1))\delta 2^n$を満たします. 従って$H$は$(1-o(1))\delta$-密です.</p><p>なお, ここでも以降でも$o(1)$の項はHoeffdingの不等式に由来するものであり, $n^{-\omega(1)}$ととることができます.</p><p><strong>ハードコア性の証明</strong></p><p>ランダム集合$H$が正の確率でハードコア性を持つことを示します. 具体的には</p>\[\begin{align*} \Pr_{H} \qty[ \tinyforall C \in \SIZE(c\delta^2\varepsilon^2 s),\,\Pr_{x\sim H} \qty[ C(x) = f(x) ] \le \frac{1}{2} + \varepsilon ] \ge 1-o(1) \tag{9} \end{align*}\]<p>を示します. まず, 内部の確率</p>\[\begin{align*} \Pr_{x\sim H} \qty[ C(x) = f(x) ] &amp;= \frac{\sum_{x\in H} \indicator_{C(x)=f(x)}}{|H|} \end{align*}\]<p>の分子と分母を評価します. 密性の証明の議論から, 集合$H$は確率$0.99$で$\abs{H}\ge(1-o(1))\abs{M}$となります.</p><p>一方で, 任意に固定した回路$C \in \SIZE(c\delta^2\varepsilon^2 s)$に対して, 分子を評価します. 集合$A_C=\qty{ x\in\binset^n\colon C(x) = f(x)}$を$C$が正解するインスタンスの集合とすると</p>\[\begin{align*} \sum_{x\in H} \indicator_{C(x)=f(x)} = \sum_{x\in A_C} \indicator_{x\in H} \end{align*}\]<p>は($H$の選び方のランダムネスに関して)独立な$\abs{A_C}$個の確率変数の和となり, しかもその期待値は</p>\[\begin{align*} \sum_{x\in A_C} \Pr\qty[ x\in H ] &amp;= \sum_{x\in A_C} M(x) \\ &amp;= \abs{M} \sum_{x\in \binset^n} \frac{M(x)}{\abs{M}}\cdot \indicator_{C(x)=f(x)} \\ &amp;= \abs{M} \Pr_{x\sim \calL_M} \qty[ C(x)=f(x) ] \\ &amp;\le \abs{M} \qty( \frac{1}{2} + \varepsilon ) \end{align*}\]<p>を満たします (最後の不等号で測度$M$のハードコア性を用いた). 従って <a href="/nobunote/docs/tools/prob_inequalities#hoeffding-inequality">Hoeffdingの不等式</a>より, 確率$1-2^{-\Omega(2^n)}$で$\abs{A_C\cap H} \le (1+o(1))\abs{M}\qty(\frac{1}{2}+\varepsilon)$を満たします.</p><p>考える回路$C$のサイズが高々$s\le 2^{o(n)}$なので, $C$としてありうる回路の個数は高々$2^{\poly(s)}=2^{2^{o(n)}}$個ですので, $C$に関するunion boundより</p>\[\begin{align*} \Pr_H \qty[ \tinyforall C\in\SIZE(c\delta^2\varepsilon^2 s), \sum_{x\in H} \indicator_{C(x)=f(x)} \le (1+o(1))\abs{M}\qty(\frac{1}{2}+\varepsilon) ] \ge 0.99 \end{align*}\]<p>となるので, $H$が確率$0.99$で$\delta$-密であることも踏まえると, 確率$0.98$で</p>\[\begin{align*} \tinyforall C\in \SIZE(c\delta^2\varepsilon^2s), \Pr_{x\sim H} \qty[C(x)=f(x)] \le \frac{1}{2} + \varepsilon - o(1) \end{align*}\]<p>となり, (9)を得ます. $\square$</p></details></main><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2024 Nobutaka Shimizu. <a href="https://docs.github.com/ja/pages/getting-started-with-github-pages/about-github-pages">This site is powered by Github Pages.</a></p><div class="d-flex mt-2"></div></footer></div></div><div class="search-overlay"></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>
